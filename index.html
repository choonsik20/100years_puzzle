<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ë°±ë…„ì²­ì‚¬: ìŠ¬ë¼ì´ë“œ í¼ì¦</title>
<link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
<style>
  html,body {height:100%; margin:0; background:#fff; font-family:'Jua', sans-serif;}
  .slide { display:none; width:100vw; height:100vh; position:relative; overflow:hidden; }
  .slide.active { display:block; }

  /* í¼ì¦ ë³´ë“œ */
  #board {
    position:absolute; top:115px; left:1601px; width:805px; height:1198px;
    display:grid;
    background:transparent;
    box-sizing:border-box;
  }
  .tile {
    box-sizing:border-box;
    border:0;
    background-repeat:no-repeat;
    background-size:cover;
    cursor:pointer;
  }
  .tile.empty { background:none; cursor:default; }

  /* ë§í’ì„  */
  #bubble {
    position:absolute; top:724px; left:778px;
    width:468px; height:357px;
    font-size:60px;
    font-weight:600;
    display:flex; justify-content:center; align-items:center;
    text-align:center; padding:10px;
    line-height:1.05;
    pointer-events:none;
  }

  .btn-area {
    position:absolute;
    z-index:9999;
    cursor:pointer;
    background:transparent;
  }
</style>
</head>
<body>

<!-- 1ë²ˆ ìŠ¬ë¼ì´ë“œ -->
<div id="slide1" class="slide active">
  <div style="position:relative; display:inline-block;">
    <img src="1.png" width="2560" height="1440" alt="">
    <div onclick="showSlide(2)"
         style="position:absolute; top:1034px; left:2162px; width:200px; height:200px; cursor:pointer; opacity:0;"></div>
  </div>
</div>

<!-- 2ë²ˆ ìŠ¬ë¼ì´ë“œ -->
<div id="slide2" class="slide">
  <img src="2.png" width="2560" height="1440" alt="">
</div>

<!-- 3ë²ˆ ìŠ¬ë¼ì´ë“œ -->
<div id="slide3" class="slide">
  <div style="position:relative; display:inline-block;">
    <img src="3.png" width="2560" height="1440" alt="">
    <div onclick="showSlide(4)"
         style="position:absolute; top:1034px; left:2162px; width:200px; height:200px; cursor:pointer; opacity:0;"></div>
  </div>
</div>

<!-- 4ë²ˆ ì„ íƒ í™”ë©´ -->
<div id="slide4" class="slide">
  <div style="position:relative; display:inline-block;">
    <img src="4.png" width="2560" height="1440" alt="ì„ íƒí™”ë©´">

    <img src="2024_ë¶€ì‚° ì„ì‹œìˆ˜ë„ ì •ë¶€ì²­ì‚¬ (10).jpg"
         style="position:absolute; top:381px; left:243px; width:554px; height:752px; object-fit:cover; cursor:pointer;"
         onclick="startPuzzle('day')" alt="ë‚® ì‚¬ì§„">

    <img src="2024_ë¶€ì‚° ì„ì‹œìˆ˜ë„ ì •ë¶€ì²­ì‚¬ (14).jpg"
         style="position:absolute; top:381px; left:1725px; width:554px; height:752px; object-fit:cover; cursor:pointer;"
         onclick="startPuzzle('poster')" alt="í¬ìŠ¤í„° ì‚¬ì§„">
  </div>
</div>

<!-- 5ë²ˆ í¼ì¦ í™”ë©´ -->
<div id="slide5" class="slide">
  <div style="position:relative; display:inline-block;">
    <img src="5-1.png" width="2560" height="1440" alt="í¼ì¦í™”ë©´ë°°ê²½">
    <div id="bubble">ì„ê¸°ë¥¼ ëˆ„ë¥´ê³  í¼ì¦ì„ ì‹œì‘í•˜ìğŸ§©</div>
    <div id="board" aria-label="í¼ì¦ ë³´ë“œ"></div>
    <div class="btn-area" onclick="onClickShuffle()" style="top:441px; left:277px; width:360px; height:150px;"></div>
    <div class="btn-area" onclick="onClickReset()" style="top:644px; left:277px; width:360px; height:150px;"></div>
  </div>
</div>

<!-- 6ë²ˆ ê³ ë§ˆì›Œ í™”ë©´ -->
<div id="slide6" class="slide">
  <img src="6.png" width="100%" height="100%" style="object-fit:contain;" alt="ê³ ë§ˆì›Œ">
</div>

<script>
/* ---------------- ìŠ¬ë¼ì´ë“œ ì œì–´ ---------------- */
let currentSlide = 1;
function showSlide(n){
  document.querySelectorAll('.slide').forEach(s => s.classList.remove('active'));
  const s = document.getElementById('slide' + n);
  if (!s) return;
  s.classList.add('active');
  currentSlide = n;
  if (n === 2) setTimeout(()=> showSlide(3), 3000);
}

/* ---------------- í¼ì¦ ë¡œì§ ---------------- */
const N = 3;
let state = [];
let imgUrl = "";
let intervalMsg = null;

function startPuzzle(type){
  if (type === 'day') imgUrl = "2024_ë¶€ì‚° ì„ì‹œìˆ˜ë„ ì •ë¶€ì²­ì‚¬ (10).jpg";
  else imgUrl = "2024_ë¶€ì‚° ì„ì‹œìˆ˜ë„ ì •ë¶€ì²­ì‚¬ (14).jpg";
  initPuzzle();
  showSlide(5);
}

function initPuzzle(){
  state = Array.from({length: N*N}, (_,i) => (i === N*N - 1 ? 0 : i+1));
  const b = document.getElementById('bubble');
  b.textContent = "ì„ê¸°ë¥¼ ëˆ„ë¥´ê³  í¼ì¦ì„ ì‹œì‘í•˜ìğŸ§©~!";
  if (intervalMsg) clearInterval(intervalMsg);
  let toggle = false;
  intervalMsg = setInterval(()=>{
    b.textContent = toggle ? "í™”ì´íŒ…! í•  ìˆ˜ ìˆì–´!" : "í˜ë“¤ë‹¤ë©´ 'ì •ë‹µ'ì„ ëˆŒëŸ¬ì„œ ì²˜ìŒë¶€í„° ì‹œì‘í•  ìˆ˜ ìˆì–´";
    toggle = !toggle;
  }, 30000);
  render();
}

function render(){
  const board = document.getElementById('board');
  board.innerHTML = '';
  const boardW = board.clientWidth || 805;
  const boardH = board.clientHeight || 1198;
  const pieceW = Math.floor(boardW / N);
  const pieceH = Math.floor(boardH / N);
  board.style.gridTemplateColumns = `repeat(${N}, ${pieceW}px)`;
  board.style.gridTemplateRows = `repeat(${N}, ${pieceH}px)`;

  for (let i = 0; i < N*N; i++){
    const v = state[i];
    const tile = document.createElement('div');
    tile.className = 'tile';
    tile.style.width = pieceW + 'px';
    tile.style.height = pieceH + 'px';

    if (v === 0) {
      tile.classList.add('empty');
    } else {
      const r = Math.floor((v-1) / N), c = (v-1) % N;
      tile.style.backgroundImage = `url("${imgUrl}")`;
      tile.style.backgroundSize = `${boardW}px ${boardH}px`;
      tile.style.backgroundPosition = `-${c * pieceW}px -${r * pieceH}px`;
      tile.onclick = ()=> move(i);
    }
    board.appendChild(tile);
  }
}

function indexOfEmpty(){ return state.indexOf(0); }

function move(i){
  const empty = indexOfEmpty();
  const er = Math.floor(empty / N), ec = empty % N;
  const r = Math.floor(i / N), c = i % N;
  if (Math.abs(er - r) + Math.abs(ec - c) === 1){
    [state[i], state[empty]] = [state[empty], state[i]];
    render();
    if (checkWin()) win();
  }
}

function shuffle(){
  for (let k = 0; k < 200; k++){
    const empty = indexOfEmpty();
    const er = Math.floor(empty / N), ec = empty % N;
    const neigh = [];
    if (er > 0) neigh.push(empty - N);
    if (er < N - 1) neigh.push(empty + N);
    if (ec > 0) neigh.push(empty - 1);
    if (ec < N - 1) neigh.push(empty + 1);
    const choice = neigh[Math.floor(Math.random() * neigh.length)];
    [state[empty], state[choice]] = [state[choice], state[empty]];
  }
  render();
  document.getElementById('bubble').textContent = "ì„ê¸°ë¥¼ ëˆ„ë¥´ê³  í¼ì¦ì„ ì‹œì‘í•˜ìğŸ§©~!";
}

function reset(){
  state = Array.from({length:N*N},(_,i)=> (i===N*N-1 ? 0 : i+1));
  render();
  document.getElementById('bubble').textContent = "ë‹¤ì‹œ í•´ë³´ì!";
}

function checkWin(){
  for (let i=0; i<state.length-1; i++){
    if (state[i] !== i+1) return false;
  }
  return state[state.length-1] === 0; // ë§ˆì§€ë§‰ ì¹¸ì´ ë¹ˆì¹¸(0)ì¸ì§€ í™•ì¸
}

function win(){
  if (intervalMsg) { clearInterval(intervalMsg); intervalMsg = null; }
  showSlide(6); // ê³ ë§ˆì›Œ í™”ë©´
  setTimeout(() => { showSlide(1); }, 10000); // 10ì´ˆ ë’¤ ì²˜ìŒìœ¼ë¡œ
}

/* ë²„íŠ¼ ì´ë²¤íŠ¸ */
function onClickShuffle(){ shuffle(); }
function onClickReset(){ reset(); }

/* ì´ˆê¸° í™”ë©´ */
showSlide(1);
</script>
</body>
</html>
